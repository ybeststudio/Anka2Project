; Listing generated by Microsoft (R) Optimizing Compiler Version 19.44.35219.0 

	TITLE	c:\anka2project\anka2project\source\binary\vs_files\userinterface\release\instancebasemotion.obj
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB OLDNAMES

EXTRN	?ELTimer_GetServerMSec@@YAKXZ:PROC		; ELTimer_GetServerMSec
EXTRN	?SetFishingPosition@CActorInstance@@QAEXAAUD3DXVECTOR3@@@Z:PROC ; CActorInstance::SetFishingPosition
EXTRN	?PixelPositionToD3DXVECTOR3@@YAXABUD3DXVECTOR3@@PAU1@@Z:PROC ; PixelPositionToD3DXVECTOR3
EXTRN	?isLock@CActorInstance@@QAEHXZ:PROC		; CActorInstance::isLock
EXTRN	?SetEndStopMotion@CGraphicThingInstance@@QAEXXZ:PROC ; CGraphicThingInstance::SetEndStopMotion
EXTRN	?ResetLocalTime@CGraphicThingInstance@@QAEXXZ:PROC ; CGraphicThingInstance::ResetLocalTime
EXTRN	?PushLoopMotion@CActorInstance@@QAE_NKMM@Z:PROC	; CActorInstance::PushLoopMotion
EXTRN	?PushOnceMotion@CActorInstance@@QAE_NKMM@Z:PROC	; CActorInstance::PushOnceMotion
EXTRN	?SetLoopMotion@CActorInstance@@QAEXKMM@Z:PROC	; CActorInstance::SetLoopMotion
PUBLIC	??$EL_DegreeToRadian@M@@YAMM@Z			; EL_DegreeToRadian<float>
PUBLIC	??$ELPlainCoord_GetRotatedPixelPosition@M@@YAXMMMMPAM0@Z ; ELPlainCoord_GetRotatedPixelPosition<float>
PUBLIC	?ActEmotion@CInstanceBase@@QAEXK@Z		; CInstanceBase::ActEmotion
PUBLIC	?ActDualEmotion@CInstanceBase@@QAEXAAV1@GG@Z	; CInstanceBase::ActDualEmotion
PUBLIC	?__DisableChangingTCPState@CInstanceBase@@IAEXXZ ; CInstanceBase::__DisableChangingTCPState
PUBLIC	?GetFishingRot@CInstanceBase@@QAEHPAH@Z		; CInstanceBase::GetFishingRot
PUBLIC	?CatchFail@CInstanceBase@@QAEXXZ		; CInstanceBase::CatchFail
PUBLIC	?CatchSuccess@CInstanceBase@@QAEXXZ		; CInstanceBase::CatchSuccess
PUBLIC	?ReactFishing@CInstanceBase@@QAEXXZ		; CInstanceBase::ReactFishing
PUBLIC	?StopFishing@CInstanceBase@@QAEXXZ		; CInstanceBase::StopFishing
PUBLIC	?StartFishing@CInstanceBase@@QAEXM@Z		; CInstanceBase::StartFishing
PUBLIC	?isLock@CInstanceBase@@QAEHXZ			; CInstanceBase::isLock
PUBLIC	?PushLoopMotion@CInstanceBase@@QAEXGMM@Z	; CInstanceBase::PushLoopMotion
PUBLIC	?PushOnceMotion@CInstanceBase@@QAEXGMM@Z	; CInstanceBase::PushOnceMotion
PUBLIC	?SetLoopMotion@CInstanceBase@@QAEXGMM@Z		; CInstanceBase::SetLoopMotion
PUBLIC	?SetMotionMode@CInstanceBase@@QAEXH@Z		; CInstanceBase::SetMotionMode
PUBLIC	?__EnableChangingTCPState@CInstanceBase@@IAEXXZ	; CInstanceBase::__EnableChangingTCPState
; Function compile flags: /Ogtp
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\InstanceBaseMotion.cpp
; File C:\Anka2Project\Anka2Project\Source\Binary\extern\include\d3dx8math.inl
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\InstanceBaseMotion.cpp
; File C:\Anka2Project\Anka2Project\Source\Binary\extern\include\d3dx8math.inl
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\InstanceBaseMotion.cpp
; File C:\Anka2Project\Anka2Project\Source\Binary\extern\include\d3dx8math.inl
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\InstanceBaseMotion.cpp
; File C:\Anka2Project\Anka2Project\Source\Binary\extern\include\d3dx8math.inl
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\InstanceBaseMotion.cpp
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\AbstractSingleton.h
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\InstanceBaseMotion.cpp
;	COMDAT ?ActDualEmotion@CInstanceBase@@QAEXAAV1@GG@Z
_TEXT	SEGMENT
_kDstPosition$ = -24					; size = 12
_this$1$ = -12						; size = 4
tv339 = -8						; size = 4
tv338 = -4						; size = 4
_rkDstInst$ = 8						; size = 4
tv373 = 8						; size = 4
_wMotionNumber1$ = 12					; size = 2
_wMotionNumber2$ = 16					; size = 2
?ActDualEmotion@CInstanceBase@@QAEXAAV1@GG@Z PROC	; CInstanceBase::ActDualEmotion, COMDAT
; _this$ = ecx

; 127  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 18	 sub	 esp, 24			; 00000018H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	8b f1		 mov	 esi, ecx
  0000a	57		 push	 edi
  0000b	89 75 f4	 mov	 DWORD PTR _this$1$[ebp], esi

; 128  : 	if (!IsWaiting())

  0000e	e8 00 00 00 00	 call	 ?IsWaiting@CInstanceBase@@QAEHXZ ; CInstanceBase::IsWaiting
  00013	85 c0		 test	 eax, eax
  00015	75 1f		 jne	 SHORT $LN2@ActDualEmo

; 129  : 	{
; 130  : 		m_GraphicThingInstance.SetLoopMotion(CRaceMotionData::NAME_WAIT, 0.05f);

  00017	83 ec 08	 sub	 esp, 8
  0001a	8d 8e f4 02 00
	00		 lea	 ecx, DWORD PTR [esi+756]
  00020	c7 44 24 04 00
	00 80 3f	 mov	 DWORD PTR [esp+4], 1065353216 ; 3f800000H
  00028	c7 04 24 cd cc
	4c 3d		 mov	 DWORD PTR [esp], 1028443341 ; 3d4ccccdH
  0002f	6a 01		 push	 1
  00031	e8 00 00 00 00	 call	 ?SetLoopMotion@CActorInstance@@QAEXKMM@Z ; CActorInstance::SetLoopMotion
$LN2@ActDualEmo:

; 131  : 	}
; 132  : 	if (!rkDstInst.IsWaiting())

  00036	8b 5d 08	 mov	 ebx, DWORD PTR _rkDstInst$[ebp]
  00039	8b cb		 mov	 ecx, ebx
  0003b	e8 00 00 00 00	 call	 ?IsWaiting@CInstanceBase@@QAEHXZ ; CInstanceBase::IsWaiting
  00040	85 c0		 test	 eax, eax
  00042	75 1f		 jne	 SHORT $LN3@ActDualEmo

; 133  : 	{
; 134  : 		rkDstInst.m_GraphicThingInstance.SetLoopMotion(CRaceMotionData::NAME_WAIT, 0.05f);

  00044	83 ec 08	 sub	 esp, 8
  00047	8d 8b f4 02 00
	00		 lea	 ecx, DWORD PTR [ebx+756]
  0004d	c7 44 24 04 00
	00 80 3f	 mov	 DWORD PTR [esp+4], 1065353216 ; 3f800000H
  00055	c7 04 24 cd cc
	4c 3d		 mov	 DWORD PTR [esp], 1028443341 ; 3d4ccccdH
  0005c	6a 01		 push	 1
  0005e	e8 00 00 00 00	 call	 ?SetLoopMotion@CActorInstance@@QAEXKMM@Z ; CActorInstance::SetLoopMotion
$LN3@ActDualEmo:

; 135  : 	}
; 136  : 
; 137  : 	const float c_fEmotionDistance = 100.0f;
; 138  : 	const TPixelPosition & c_rMainPosition = NEW_GetCurPixelPositionRef();

  00063	8b ce		 mov	 ecx, esi
  00065	e8 00 00 00 00	 call	 ?NEW_GetCurPixelPositionRef@CInstanceBase@@IAEABUD3DXVECTOR3@@XZ ; CInstanceBase::NEW_GetCurPixelPositionRef

; 139  : 	const TPixelPosition & c_rTargetPosition = rkDstInst.NEW_GetCurPixelPositionRef();

  0006a	8b cb		 mov	 ecx, ebx
  0006c	8b f8		 mov	 edi, eax
  0006e	e8 00 00 00 00	 call	 ?NEW_GetCurPixelPositionRef@CInstanceBase@@IAEABUD3DXVECTOR3@@XZ ; CInstanceBase::NEW_GetCurPixelPositionRef
; File C:\Anka2Project\Anka2Project\Source\Binary\extern\include\d3dx8math.inl

; 263  :     return D3DXVECTOR3(x - v.x, y - v.y, z - v.z);

  00073	f3 0f 10 47 04	 movss	 xmm0, DWORD PTR [edi+4]
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\InstanceBaseMotion.cpp

; 139  : 	const TPixelPosition & c_rTargetPosition = rkDstInst.NEW_GetCurPixelPositionRef();

  00078	8b f0		 mov	 esi, eax
; File C:\Anka2Project\Anka2Project\Source\Binary\extern\include\d3dx8math.inl

; 263  :     return D3DXVECTOR3(x - v.x, y - v.y, z - v.z);

  0007a	f3 0f 10 17	 movss	 xmm2, DWORD PTR [edi]
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\InstanceBaseMotion.cpp

; 141  : 	float fDistance = sqrtf((kDirection.x*kDirection.x) + (kDirection.y*kDirection.y));

  0007e	51		 push	 ecx
; File C:\Anka2Project\Anka2Project\Source\Binary\extern\include\d3dx8math.inl

; 263  :     return D3DXVECTOR3(x - v.x, y - v.y, z - v.z);

  0007f	f3 0f 5c 46 04	 subss	 xmm0, DWORD PTR [esi+4]
  00084	f3 0f 5c 16	 subss	 xmm2, DWORD PTR [esi]

; 181  :     y = fy;

  00088	0f 28 c8	 movaps	 xmm1, xmm0

; 263  :     return D3DXVECTOR3(x - v.x, y - v.y, z - v.z);

  0008b	f3 0f 11 45 f8	 movss	 DWORD PTR tv339[ebp], xmm0

; 181  :     y = fy;

  00090	f3 0f 59 c8	 mulss	 xmm1, xmm0
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\InstanceBaseMotion.cpp

; 141  : 	float fDistance = sqrtf((kDirection.x*kDirection.x) + (kDirection.y*kDirection.y));

  00094	0f 28 c2	 movaps	 xmm0, xmm2
  00097	f3 0f 59 c2	 mulss	 xmm0, xmm2
; File C:\Anka2Project\Anka2Project\Source\Binary\extern\include\d3dx8math.inl

; 263  :     return D3DXVECTOR3(x - v.x, y - v.y, z - v.z);

  0009b	f3 0f 11 55 fc	 movss	 DWORD PTR tv338[ebp], xmm2
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\InstanceBaseMotion.cpp

; 141  : 	float fDistance = sqrtf((kDirection.x*kDirection.x) + (kDirection.y*kDirection.y));

  000a0	f3 0f 58 c8	 addss	 xmm1, xmm0
  000a4	f3 0f 11 0c 24	 movss	 DWORD PTR [esp], xmm1
  000a9	e8 00 00 00 00	 call	 _sqrtf
  000ae	f3 0f 10 55 fc	 movss	 xmm2, DWORD PTR tv338[ebp]
  000b3	83 c4 04	 add	 esp, 4
  000b6	d9 5d 08	 fstp	 DWORD PTR tv373[ebp]
  000b9	f3 0f 5e 55 08	 divss	 xmm2, DWORD PTR tv373[ebp]

; 142  : 	TPixelPosition kDstPosition;
; 143  : 	kDstPosition.x = c_rTargetPosition.x + (kDirection.x/fDistance)*c_fEmotionDistance;

  000be	f3 0f 59 15 00
	00 00 00	 mulss	 xmm2, DWORD PTR __real@42c80000
  000c6	f3 0f 58 16	 addss	 xmm2, DWORD PTR [esi]
  000ca	f3 0f 11 55 e8	 movss	 DWORD PTR _kDstPosition$[ebp], xmm2
  000cf	f3 0f 10 55 f8	 movss	 xmm2, DWORD PTR tv339[ebp]
  000d4	f3 0f 5e 55 08	 divss	 xmm2, DWORD PTR tv373[ebp]

; 144  : 	kDstPosition.y = c_rTargetPosition.y + (kDirection.y/fDistance)*c_fEmotionDistance;

  000d9	f3 0f 59 15 00
	00 00 00	 mulss	 xmm2, DWORD PTR __real@42c80000
  000e1	f3 0f 58 56 04	 addss	 xmm2, DWORD PTR [esi+4]
  000e6	f3 0f 11 55 ec	 movss	 DWORD PTR _kDstPosition$[ebp+4], xmm2

; 145  : 
; 146  : 	DWORD dwCurTime = ELTimer_GetServerMSec() + 500;

  000eb	e8 00 00 00 00	 call	 ?ELTimer_GetServerMSec@@YAKXZ ; ELTimer_GetServerMSec

; 147  : 	PushTCPStateExpanded(dwCurTime, kDstPosition, 0.0f, FUNC_EMOTION, MAKELONG(wMotionNumber1, wMotionNumber2), rkDstInst.GetVirtualID());

  000f0	8b cb		 mov	 ecx, ebx
  000f2	8d b0 f4 01 00
	00		 lea	 esi, DWORD PTR [eax+500]
  000f8	e8 00 00 00 00	 call	 ?GetVirtualID@CInstanceBase@@QAEKXZ ; CInstanceBase::GetVirtualID
  000fd	0f b7 55 10	 movzx	 edx, WORD PTR _wMotionNumber2$[ebp]
  00101	0f 57 db	 xorps	 xmm3, xmm3
  00104	0f b7 4d 0c	 movzx	 ecx, WORD PTR _wMotionNumber1$[ebp]
  00108	50		 push	 eax
  00109	c1 e2 10	 shl	 edx, 16			; 00000010H
  0010c	8d 45 e8	 lea	 eax, DWORD PTR _kDstPosition$[ebp]
  0010f	0b d1		 or	 edx, ecx
  00111	52		 push	 edx
  00112	51		 push	 ecx
  00113	50		 push	 eax
  00114	56		 push	 esi
  00115	8b 75 f4	 mov	 esi, DWORD PTR _this$1$[ebp]
  00118	8b ce		 mov	 ecx, esi
  0011a	e8 00 00 00 00	 call	 ?PushTCPStateExpanded@CInstanceBase@@QAEXKABUD3DXVECTOR3@@MIII@Z ; CInstanceBase::PushTCPStateExpanded

; 148  : 
; 149  : 	__DisableChangingTCPState();

  0011f	8b ce		 mov	 ecx, esi
  00121	e8 00 00 00 00	 call	 ?__DisableChangingTCPState@CInstanceBase@@IAEXXZ ; CInstanceBase::__DisableChangingTCPState

; 150  : 	rkDstInst.__DisableChangingTCPState();

  00126	8b cb		 mov	 ecx, ebx
  00128	e8 00 00 00 00	 call	 ?__DisableChangingTCPState@CInstanceBase@@IAEXXZ ; CInstanceBase::__DisableChangingTCPState

; 151  : 
; 152  : 	if (__IsMainInstance() || rkDstInst.__IsMainInstance())

  0012d	8b ce		 mov	 ecx, esi
  0012f	e8 00 00 00 00	 call	 ?__IsMainInstance@CInstanceBase@@IAE_NXZ ; CInstanceBase::__IsMainInstance
  00134	84 c0		 test	 al, al
  00136	75 0b		 jne	 SHORT $LN5@ActDualEmo
  00138	8b cb		 mov	 ecx, ebx
  0013a	e8 00 00 00 00	 call	 ?__IsMainInstance@CInstanceBase@@IAE_NXZ ; CInstanceBase::__IsMainInstance
  0013f	84 c0		 test	 al, al
  00141	74 2c		 je	 SHORT $LN4@ActDualEmo
$LN5@ActDualEmo:
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\AbstractSingleton.h

; 24   : 		assert(ms_singleton!=nullptr);

  00143	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$TAbstractSingleton@VIAbstractPlayer@@@@0PAVIAbstractPlayer@@A ; TAbstractSingleton<IAbstractPlayer>::ms_singleton
  00149	85 c9		 test	 ecx, ecx
  0014b	75 1a		 jne	 SHORT $LN15@ActDualEmo
  0014d	6a 18		 push	 24			; 00000018H
  0014f	68 00 00 00 00	 push	 OFFSET ??_C@_1KI@FIPHLMOB@?$AAC?$AA?3?$AA?2?$AAA?$AAn?$AAk?$AAa?$AA2?$AAP?$AAr?$AAo?$AAj?$AAe?$AAc?$AAt@
  00154	68 00 00 00 00	 push	 OFFSET ??_C@_1CM@FPMBEAEA@?$AAm?$AAs?$AA_?$AAs?$AAi?$AAn?$AAg?$AAl?$AAe?$AAt?$AAo?$AAn?$AA?$CB?$AA?$DN?$AAn@
  00159	e8 00 00 00 00	 call	 __wassert
  0015e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?ms_singleton@?$TAbstractSingleton@VIAbstractPlayer@@@@0PAVIAbstractPlayer@@A ; TAbstractSingleton<IAbstractPlayer>::ms_singleton
  00164	83 c4 0c	 add	 esp, 12			; 0000000cH
$LN15@ActDualEmo:
; File C:\Anka2Project\Anka2Project\Source\Binary\source\UserInterface\InstanceBaseMotion.cpp

; 155  : 		rPlayer.StartEmotionProcess();

  00167	8b 01		 mov	 eax, DWORD PTR [ecx]
  00169	ff 90 84 00 00
	00		 call	 DWORD PTR [eax+132]
$LN4@ActDualEmo:

; 156  : 	}
; 157  : }

  0016f	5f		 pop	 edi
  00170	5e		 pop	 esi
  00171	5b		 pop	 ebx
  00172	8b e5		 mov	 esp, ebp
  00174	5d		 pop	 ebp
  00175	c2 0c 00	 ret	 12			; 0000000cH
?ActDualEmotion@CInstanceBase@@QAEXAAV1@GG@Z ENDP	; CInstanceBase::ActDualEmotion
_TEXT	ENDS
END
